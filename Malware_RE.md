

# File encrypter RE

### I found a quite useful binary that can encrypt files with its own encryption algorithm.
### The code is also public but in this case we will suppose we don't have it!
**PS: According to @highsenburger69 this shit ain't a malware, i agree, but cmon, it's my first time <3**
# RE TIME :)

* **Let's start by opening the binary on IDA (free version ofc :()**

 ![](https://i.imgur.com/FGaz6bC.png)
 
 
 
 
> Okay we can already understand what it's doing...

Let's start from the beggining, it prints something and then it uses scanf to take our input(that in this case is a filename).

Then it tries to open the file, if the file exists it continues execution, if not it exits.

Let's continue.

![](https://i.imgur.com/FYYBdfb.png)
 It checks if it can write to a file(temp.txt), if not it exits.
 
 We see an intresting structure here that might be the encryption algorithm, i mean we have a loop, what else would it be in this case?

Let's try to understand what it's doing. 
 It uses fgetc to get each char out of he file.
 The pseudocode should look something like this:
 
 ``` 
 newchr = 0
 for each char in file:
 		newchr=hex(char)+0x64 
```
After that fputc is used on a loop to write the new characters to the file

![](https://i.imgur.com/o4nPi4n.png)

Now that we know that the encryption is stupid af we can easily reverse the encrypted string to the original one!

Let's see how we can do it
I encrypted a file with character 'A' as content and the hex of the encrypted value was 0xa5

```
fzr@zorzor:~/Desktop/exploits/mal$ hexdump mike.txt 
0000000 6ea5                                   
0000002
fzr@zorzor:~/Desktop/exploits/mal$ python
Python 2.7.13 (default, Sep 26 2018, 18:42:22) 
[GCC 6.3.0 20170516] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> chr(0xa5-0x64)
'A'
```

This writeup hasn't finished so stay tuned for an update.
Feel free to message me and inform me of how dumb i am :)
